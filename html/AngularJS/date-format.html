<!DOCTYPE html>
<html>
   <head>
      <meta charset='utf-8'>
      <meta http-equiv="X-UA-Compatible" content="chrome=1">
      <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
      <meta name="description" content="iphone上时间转换NaN问题,Safari下转换时间，需要这种格式.">
      <meta name="keywords" content="吴杨杨,个人博客,iphone上时间转换NaN问题,angularjs,tgwuyangyang.github.io">
      <LINK href="../../images/wu.ico" type="img/x-icon" rel=icon>
      <link rel="stylesheet" type="text/css" href="../../css/stylesheet.css" media="screen">
      <link rel="stylesheet" type="text/css" href="../../css/html/content.css">
      <title>吴杨杨的个人博客</title>
   </head>

   <body>
      <div id="container">
         <div class="inner">
            <header>
               <h1>Tgwuyangyang.GitHub.com</h1>
            </header>
            <hr>
            <p class="title"><span>angularjs学习笔记--iphone上时间转换NaN问题</span></p>
            <hr>
            <section id="main_content">
               <p class="author">
                  <span>作者：吴杨杨</span>
                  <a class="back" href="../../index.html">返回首页</a>
               </p>
               <p class="time"><span>时间：2016-08-06</span></p>
               <p>一周以前，我遇到一个问题，当时后台传来一个时间，格式是这样的</p>
               <blockquote>
                  <ul>
                     <li>2016-07-31 11:20:30.0</li>
                  </ul>
               </blockquote>
               <p>由于用的是angularjs框架，所以值就这么显示在了页面上</p>
               <p>然后，给我分了一个bug，要让我将后面的.0去掉。我一看，这多简单啊，一格式化不就好了</p>
               <pre><code>var time = new Date(parameter);<br>format(time); // 格式化（yyyy-MM-dd HH:mm:ss）
               </code></pre>
               <p>Google Chrome上一调试，好了。</p>
               <p>过了一会，我无意中拿出了手机，上企业号上一看，时间显示NaN。马上打开代码检查，重新部署了一下，Chrome上测试，确实没问题。然后，iphone真机测试，还是乱码。我去，瞬间凌乱了......</p>
               <p>没办法了，只好使出杀手锏。传说中的截取字符串，把最后两位截掉，终于好了。</p>
               <pre><code>var str = "2016-07-31 11:20:30.0";<br>str = str.substring(0, 19);
               </code></pre>
               <p>几天后，又来一个bug，时间格式是这样的</p>
               <blockquote>
                  <ul>
                     <li>2016-7-31 11:20:30</li>
                  </ul>
               </blockquote>
               <p>让我把月份改成这样</p>
               <blockquote>
                  <ul>
                     <li>2016-07-31 11:20:30</li>
                  </ul>
               </blockquote>
               <p>看到这，心真的好累......</p>
               <p>没办法，只好找出格式化失败的原因。功夫不负有心人，终于找出来了。</p>
               <p>Safari下转换时间，需要这种格式</p>
               <blockquote>
                  <ul>
                     <li>yyyy/MM/dd hh:mm:ss</li>
                  </ul>
               </blockquote>
               <p>所以，这样处理时间就好了</p>
               <pre><code>var str = "2016-07-31 11:20:30";<br>str = str.replace(/\-/g, '/');<br>str = new Date(str).getTime();
               </code></pre>
               <p>把‘-’换成‘/’，再format就好了。</p>
               <p>以上。</p>
               <hr>
               <section id="downloads" class="clearfix">
               <a href="../../index.html">返回首页</a>
               <a style="float:right;" href="https://github.com/tgwuyangyang" id="view-on-github" class="button">
                  <span>View on GitHub</span>
               </a>
            </section>
            </section>
            <footer>
               <table class="border-none">
                  <tr>
                     <td class="border-none">
                        This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
                     </td>
                  </tr>
               </table>
            </footer>
         </div>
      </div>
      <script src="../../js/jquery-2.1.4.min.js" type="text/javascript" charset="utf-8"></script>
   </body>
</html>
